<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 6 Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            cursor: pointer;
        }
        #test-area {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #ccc;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <h1>Phase 6 Integration Test</h1>
    
    <div id="test-results"></div>
    
    <h2>Manual Tests</h2>
    <div id="test-area">
        <button onclick="testKeyboardShortcuts()">Test Keyboard Shortcuts</button>
        <button onclick="testARIAAnnouncements()">Test ARIA Announcements</button>
        <button onclick="testMobileDetection()">Test Mobile Detection</button>
        <button onclick="testFocusTrap()">Test Focus Trap</button>
    </div>
    
    <h2>Instructions</h2>
    <ul>
        <li>Press <kbd>Alt+H</kbd> to test keyboard help dialog</li>
        <li>Press <kbd>Tab</kbd> to test skip links</li>
        <li>Enable screen reader to test announcements</li>
        <li>Use Chrome DevTools device mode to test mobile features</li>
    </ul>

    <!-- Load Alpine.js first -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Load Phase 6 modules -->
    <script type="module" src="./js/accessibility.js"></script>
    <script type="module" src="./js/mobile-optimization.js"></script>
    
    <script>
        const results = document.getElementById('test-results');
        
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            results.appendChild(div);
        }
        
        // Check module loading
        window.addEventListener('DOMContentLoaded', () => {
            // Test 1: Check if modules are loaded
            if (window.accessibilityManager) {
                addResult('✓ Accessibility module loaded successfully', 'success');
            } else {
                addResult('✗ Accessibility module not loaded', 'error');
            }
            
            if (window.mobileOptimizer) {
                addResult('✓ Mobile optimization module loaded successfully', 'success');
            } else {
                addResult('✗ Mobile optimization module not loaded', 'error');
            }
            
            // Test 2: Check skip links
            setTimeout(() => {
                const skipLinks = document.querySelectorAll('.skip-link');
                if (skipLinks.length > 0) {
                    addResult(`✓ Skip links created: ${skipLinks.length} found`, 'success');
                } else {
                    addResult('✗ Skip links not created', 'error');
                }
            }, 1000);
            
            // Test 3: Check ARIA live regions
            const statusAnnouncer = document.getElementById('status-announcer');
            const alertAnnouncer = document.getElementById('alert-announcer');
            
            if (statusAnnouncer && alertAnnouncer) {
                addResult('✓ ARIA live regions created', 'success');
            } else {
                addResult('✗ ARIA live regions not created', 'error');
            }
            
            // Test 4: Check mobile detection
            addResult(`Mobile detected: ${window.mobileOptimizer?.isMobile ? 'Yes' : 'No'}`, 'info');
            addResult(`Touch support: ${window.mobileOptimizer?.isTouch ? 'Yes' : 'No'}`, 'info');
        });
        
        function testKeyboardShortcuts() {
            addResult('Testing keyboard shortcuts...', 'info');
            addResult('Press Alt+H to open help dialog', 'info');
            
            // Simulate Alt+H
            const event = new KeyboardEvent('keydown', {
                key: 'h',
                altKey: true,
                bubbles: true
            });
            document.dispatchEvent(event);
        }
        
        function testARIAAnnouncements() {
            if (window.accessibilityManager) {
                window.accessibilityManager.announceStatus('This is a status announcement');
                window.accessibilityManager.announceAlert('This is an alert announcement');
                addResult('ARIA announcements triggered - check with screen reader', 'info');
            } else {
                addResult('Cannot test announcements - module not loaded', 'error');
            }
        }
        
        function testMobileDetection() {
            if (window.mobileOptimizer) {
                const stats = {
                    isMobile: window.mobileOptimizer.isMobile,
                    isTouch: window.mobileOptimizer.isTouch,
                    touchHandlers: window.mobileOptimizer.touchHandlers.size
                };
                addResult(`Mobile stats: ${JSON.stringify(stats, null, 2)}`, 'info');
            } else {
                addResult('Cannot test mobile detection - module not loaded', 'error');
            }
        }
        
        function testFocusTrap() {
            if (window.accessibilityManager) {
                // Create a simple modal
                const modal = document.createElement('div');
                modal.innerHTML = `
                    <div style="background: white; padding: 20px; border: 2px solid black;">
                        <h3>Test Modal</h3>
                        <p>Tab through these elements:</p>
                        <button>Button 1</button>
                        <button>Button 2</button>
                        <button onclick="this.parentElement.remove()">Close</button>
                    </div>
                `;
                document.getElementById('test-area').appendChild(modal);
                
                window.accessibilityManager.createFocusTrap(modal.firstElementChild);
                addResult('Focus trap created - try tabbing through the modal', 'info');
            } else {
                addResult('Cannot test focus trap - module not loaded', 'error');
            }
        }
    </script>
</body>
</html> 